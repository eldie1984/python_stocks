{% import "bootstrap/wtf.html" as wtf %}
{% extends "base.html" %}
{% block title %}
    {% if add_Boleto %}
        Add Boleto
    {% else %}
        Edit Boleto
    {% endif %}
{% endblock %}
{% block body %}
<div class="content-section">
 <div class="outer">
    <div class="middle">
      <div class="inner">
<div class="center">
            {% if add_Boleto %}
                <h1>Add Boleto</h1>
            {% else %}
                <h1>Edit Boleto</h1>
            {% endif %}
            <br/>
            </div>
            <div class="container">
            <form method="POST" action="/">
              <div class="form-row">
              <div class="form-group col">{{ form.numero.label }} {{ form.numero(size=20) }}</div>

              <div class="input-group mb-3 col">{{ form.tipo_operacion.label }}{{ form.tipo_operacion(class="form-control",onChange="allowInteres(this)") }}</div>
              <div class="input-group mb-3 col">{{ form.moneda.label }} {{ form.moneda(class="form-control",onChange="allowEcahnge(this)") }}</div>

              </div>
              <div class="form-row">
              <div class="col-md-auto">{{ form.fecha_concertacion.label }} {{ form.fecha_concertacion(type="date")}}</div>
              <div class="col-md-auto">{{ form.fecha_liquidacion.label }} {{ form.fecha_liquidacion(type="date") }}</div>
              <div class="col-md-auto"> {{ form.tiker(placeholder='Ticker') }}</div>
              <div class="col-md-auto">{{ form.cantidad(placeholder='Cantidad',onChange="checkNumber(this)") }}</div>
              </div>
              <div class="form-row">
                <div class="form-group col-md-auto">{{ form.perc_arancel.label }} {{ form.perc_arancel(size=20,onChange="checkNumber(this)") }}</div>
                <div class="form-group col-md-auto">{{ form.arancel.label }} {{ form.arancel(size=20,onChange="checkNumber(this)") }}</div>
                <div class="form-group col-md-auto">{{ form.mercado_importe.label }} {{ form.mercado_importe(onChange="checkNumber(this)") }}</div>
                <div class="form-group col-md-auto">{{ form.iva.label }} {{ form.iva(size=20) }}</div>
              </div>
              <div class="form-row"  id='tipo_cambio_block'>
                <div class="form-group col-md-4">{{ form.tipo_cambio.label }} {{ form.tipo_cambio(onChange="checkNumber(this)") }}</div>
                <div class="form-group col-md-4">{{ form.tipo_cambio_arancel.label }} {{ form.tipo_cambio_arancel(onChange="checkNumber(this)") }}</div>
              </div>
              <div class="form-row">
                <div class="form-group col-md-auto">{{ form.bruto.label }} {{ form.bruto(placeholder='Bruto',onChange="checkNumber(this)") }}</div>
              <div class="form-group col-md-4" >{{ form.neto.label }} {{ form.neto(placeholder='Neto',onChange="checkNumber(this)") }}</div>
              </div>
              <div class="form-row">
              <div class="form-group col-md-4">{{ form.alyc_id.label }} {{ form.alyc_id(class="form-control") }}</div>
              </div>
              <div class="form-row" id='interes_block'>
                <div class="form-group col-md-auto">{{ form.interes.label }} {{ form.interes(onChange="checkNumber(this)") }}</div>
              </div>
              <div class="form-row">
              <button type="submit" class="btn btn-primary">Cargar Boleto</button>
              </div>
          </form>
      </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block js %}
<script>
    arancelElement =document.getElementById('arancel')

    arancelElement.addEventListener('change', (event) => {
      const resultado = document.getElementById('perc_arancel');
      const bruto = parseInt(document.getElementById('bruto').value);
      resultado.value = parseInt(event.target.value) * 100 / bruto;
    });

    function checkNumber(e) {
      if (e.value.includes(',') && e.value.includes('.')) {
      e.value=e.value.replace('.', '').replace(',', '.');
      }
      else {
        e.value=e.value.replace(',', '.');
      }
    }
    document.getElementById("tipo_cambio_block").style.display = "none"
    function allowEcahnge(e) {
      if (e.value === "d") {
        document.getElementById("tipo_cambio_block").style.display = "inline"
      }else{document.getElementById("tipo_cambio_block").style.display = "none"}
    }
    document.getElementById("interes_block").style.display = "none"
    function allowInteres(e) {
      if (e.value === "acf") {
        document.getElementById("interes_block").style.display = "inline"
      }else{document.getElementById("interes_block").style.display = "none"}
    }
</script>
{% endblock %}
